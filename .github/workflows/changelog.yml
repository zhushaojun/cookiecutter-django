name: Changelog Generator

on:
  push:
    branches: [ changelog-generator ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
    - uses: actions/checkout@v2

    - name: Generate changelog content
      uses: heinrichreimer/action-github-changelog-generator@v2.1.1
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        
    - name: Write output to CHANGELOG.md
      run: |
        echo "Current directory:"
        pwd -P
        echo "Content of current directory:"
        ls -la
        echo "${{ steps.generate-changelog.outputs.changelog }}" > CHANGELOG.md
        git status

    - name: push
      uses: github-actions-x/commit@v2.5
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}
        commit-message: 'Update Changelog'
